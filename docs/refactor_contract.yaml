# refactor_contract.yaml
scope:
  module: daydreaming_dagster/unified
must_preserve:
  - Public function signatures for X,Y (unless marked @internal)
  - Input/output file formats and schema
  - Error *codes/types* and exit statuses
may_change:
  - Error *messages* and logging text
  - Exact call graph and helper boundaries
  - Internal data structure shapes (private)
should_drop:
  - Copying local variables across layers just to reproduce old error prose
  - Redundant try/except that only rewraps with similar message
  - Ad-hoc logging in hot paths; prefer boundary logging
success_criteria:
  - Tests for behaviors pass
  - Complexity metrics: LOC −10%+, function count −N, avg cyclomatic −M
non_goals:
  - Bitwise identity of log lines or exception strings
